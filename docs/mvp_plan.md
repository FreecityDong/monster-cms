太好了！下面给你一份**可直接开干的 MVP
规划**，再配一条**版本升级路线图**。技术栈保持
`Next.js + Tailwind`（前端）与 `Django REST API`（后端），DB 用
PostgreSQL。

# 一、MVP 目标与范围（4--6 周）

**目标**：最短路径上线"能教能学能管"的最小闭环\
**支持角色**：部门经理、教务、教师、学生

## 1) Must Have（MVP 范围）

-   **认证与权限**
    -   邮箱/账号登录、JWT/Session；RBAC（四角色）\
-   **课程与班级**
    -   课程目录（检索/筛选/详情）；开班（ClassSection）\
-   **排课**
    -   每周/日程视图、基本冲突校验（教师×时间段）\
-   **选课与成员**
    -   学生报名（自助/教务导入）、成员列表\
-   **出勤**
    -   点名表（到/迟/缺/请），班级出勤率\
-   **作业**
    -   布置作业（标题/截止/权重）、学生提交（文本/附件）、教师评分（分数+评语）\
-   **课后评价**
    -   固定模板问卷（满意度/建议）、结果汇总（均值/分布）\
-   **公告与提醒**
    -   班级公告、两类提醒：作业发布/截止前 24h\
-   **统计（Lite）**
    -   班级看板：出勤率、作业按时率、满意度 3 指标\
-   **基础运维**
    -   审计日志（登录/CRUD）、CSV 导出（出勤、成绩）、S3 直传

## 2) Won't/可延期（非 MVP）

-   测验题库、Rubric
    可视化打印、日历订阅（iCal）、设备/教室资源管理、抄袭查重、内容版本、NPS/人群标签、复杂报表

------------------------------------------------------------------------

# 二、信息架构（MVP 实体）

-   User（含角色/部门）\
-   Course（课程模板/介绍）\
-   ClassSection（开班）\
-   Schedule（上课时段）\
-   Enrollment（学生↔班级关系）\
-   Lesson（派生自 Schedule 或按节次落表）\
-   Attendance（出勤记录）\
-   Assignment / Submission / Grade（作业、提交、评分）\
-   Evaluation（评价问卷与答卷）\
-   Announcement（公告）\
-   AuditLog（审计）

------------------------------------------------------------------------

# 三、前后端分工与页面

## 前端（Next.js）

-   路由
    -   `/login` 登录\
    -   `/dashboard` 角色看板\
    -   `/courses` 列表与详情 `/courses/[id]`\
    -   `/classes/[id]` 详情（选项卡）
        -   `schedule` 排课周历
        -   `members` 成员/报名
        -   `assignments` 作业与批改
        -   `attendance` 出勤
        -   `evaluations` 评价结果
        -   `materials` 资源（简单文件列表）
        -   `analytics` 3 指标看板
    -   `/announcements` 公告中心
    -   `/admin`（用户/角色、字典少量配置）
-   组件：表格（分页/筛选）、日历（周视图）、文件上传、富文本、图表（Recharts）

## 后端（Django + DRF）

-   apps：`users`, `catalog`, `classes`, `assignments`, `evaluations`,
    `analytics`, `notifications`
-   关键 API（示例）
    -   `POST /auth/login`、`GET /auth/me`
    -   `GET /courses?keyword=&tag=`、`GET /courses/{id}`
    -   `POST /classes`、`GET /classes/{id}`
    -   `GET /classes/{id}/schedule`、`POST /classes/{id}/schedule`
    -   `POST /classes/{id}/enroll`、`DELETE /enrollments/{id}`
    -   `POST /classes/{id}/attendance`（批量）
    -   `POST /classes/{id}/assignments`、`GET /assignments/{id}`
    -   `POST /assignments/{id}/submissions`、`POST /submissions/{id}/grade`
    -   `POST /classes/{id}/evaluations`、`GET /evaluations/{id}/results`
    -   `POST /announcements`
    -   `GET /analytics/class/{id}/summary`（出勤率/按时率/满意度）

------------------------------------------------------------------------

# 四、MVP 用户故事（验收口径）

-   **教务**：创建班级，导入 10+ 节排课；当教师冲突时给出阻止/提示。\
-   **教师**：能在手机端勾选出勤；在一个页面完成作业批量评分并保存草稿。\
-   **学生**：报名成功后自动加入班级；在截止前 24h
    收到提醒并能上传附件提交。\
-   **经理/教务**：在班级看板能看到三指标（出勤/按时/满意度）和趋势。\
-   **所有角色**：公告在 5 秒内可见（通知延迟可 ≤60 秒）。

------------------------------------------------------------------------

# 五、数据与接口片段（MVP 级）

**Schedule**

``` json
POST /classes/{id}/schedule
[
  {"start_at":"2025-09-01T09:00:00+09:00","end_at":"2025-09-01T10:30:00+09:00","room":"R101"},
  {"start_at":"202-09-08T09:00:00+09:00","end_at":"2025-09-08T10:30:00+09:00","room":"R101"}
]
```

**Attendance 批量写入**

``` json
POST /classes/{id}/attendance
{
  "lesson_id": 123,
  "records": [
    {"student_id": 11, "status": "present"},
    {"student_id": 12, "status": "late"}
  ]
}
```

**Analytics 简报**

``` json
GET /analytics/class/{id}/summary
{
  "attendance_rate": 0.92,
  "on_time_submission_rate": 0.87,
  "satisfaction": 4.5
}
```

------------------------------------------------------------------------

# 六、里程碑与排期（示例 5 周，2--3 人）

**W1 需求/骨架** - 数据字典、权限矩阵、线框图 - Django/DRF
项目初始化、Postgres、JWT、RBAC - Next.js App Router、布局、鉴权守卫

**W2 课程/班级/排课** - 课程 CRUD、班级 CRUD、排课 API + 周历组件 -
冲突校验（教师×时间段×班级）

**W3 作业/提交/评分 + 公告** - 作业创建/列表/详情、上传直传（S3 签名） -
提交与评分、公告中心、通知模板（邮件/站内）

**W4 出勤/评价 + 看板** - 课堂点名（移动端表单/二维码任选其一） -
评价问卷（固定题型），汇总图表 - 班级看板 3 指标（出勤/按时/满意度）

**W5 硬化与上线** -
权限回归、E2E（Playwright/Cypress），Sentry/Prometheus - CSV
导出、审计日志、冷/热备份策略 - Staging→Prod 发布脚本与回滚

> 若人员不足，优先保证：排课×作业×出勤×评价×看板；公告/导出其次。

------------------------------------------------------------------------

# 七、非功能性指标（MVP 基线）

-   **性能**：主列表接口 P95 ≤ 400ms；批量写入（出勤/排课）≤ 2s/200 条\
-   **可用性**：核心 API 错误率 ≤ 0.5%；前端首屏可交互 ≤ 3s（内网环境）\
-   **安全**：对象级权限校验；文件下载签名 URL 10 分钟有效\
-   **日志/监控**：Sentry
    错误告警、结构化审计（user_id/object/action/ip）

------------------------------------------------------------------------

# 八、DevOps 与部署

-   **环境**：`dev / staging / prod` 三套；`.env` 分离\
-   **CI/CD**：GitHub Actions（lint+tests+build），main 合并即部署到
    staging，手动 promote 到 prod\
-   **数据库迁移**：Django migrations + 每日快照（7 天保留）\
-   **静态/附件**：S3/MinIO；前端静态由 CDN；Nginx 反代\
-   **蓝绿发布/回滚**：容器镜像保留最近 10 版，一键回滚

------------------------------------------------------------------------

# 九、MVP 完成后的版本路线图

## v1.1（排课与作业进阶，+2--3 周）

-   **排课增强**：教室/设备占用、节假日黑名单、iCal 订阅\
-   **作业增强**：Rubric 评分维度、批注（富文本或 PDF 高亮）\
-   **通知增强**：多渠道（Webhook/企业微信/飞书），消息模板变量

## v1.2（测验与成绩体系，+3--4 周）

-   **测验引擎**：题库（单选/多选/判断/简答）、定时、自动判分\
-   **成绩册**：权重配置、期末总评、曲线调整、成绩导出\
-   **反作弊**：随机题序、时间窗、IP/设备指纹基础校验

## v1.3（运营与数据化，+3 周）

-   **问卷中心**：课前/课后/结课问卷、NPS\
-   **标签与人群**：按出勤/分数/满意度分层，批量触达\
-   **报表中心**：教师工作量、课程转化、学期对比（可视化+导出）

## v1.4（生态与合规，+2--3 周）

-   **内容版本/版权**：课件版本化、禁二次分发策略\
-   **合规**：GDPR/数据留存策略、隐私开关\
-   **外部对接**：SSO（OIDC/SAML）、财务/HR 基础对接（只读）

------------------------------------------------------------------------

# 十、任务拆分与优先级（MoSCoW）

-   **Must**：认证/RBAC、课程/班级、排课、选课、出勤、作业、评价、公告、看板\
-   **Should**：CSV 导出、S3 直传、审计、基础通知\
-   **Could**：二维码签到、移动端优化、课程标签/收藏\
-   **Won't (now)**：测验、Rubric 可视化、iCal、资源占用

------------------------------------------------------------------------

# 十一、风险与对策

-   **权限绕过 / 越权** → 对所有对象读写做 ownership/org
    维度校验；后端统一装饰器\
-   **排课冲突复杂** → MVP 仅做"教师×时间段"，教室/设备推迟到 v1.1\
-   **文件体积与合规** → S3 生命周期+大小限制；敏感词/后缀白名单\
-   **性能热点** →
    列表接口预取/索引、分页与增量加载；统计异步化（Celery）

------------------------------------------------------------------------

# 十二、你可以立刻开始的"首 10 个 Issue"

1.  Django 项目脚手架 + Postgres/Redis 容器化\
2.  用户模型 + RBAC（Group/Permission）+ JWT 登录\
3.  课程/班级模型与 CRUD API + OpenAPI 文档\
4.  排课模型与冲突校验（教师×时间段）\
5.  前端鉴权守卫 + 角色侧边栏\
6.  班级周历页面（读写排课）\
7.  作业创建/列表/详情 API + S3 直传\
8.  提交与评分 API + 前端批量评分表格\
9.  出勤批量写入 API + 前端点名页（移动端适配）\
10. 评价问卷（固定模板）+ 结果汇总图表 + 班级看板
